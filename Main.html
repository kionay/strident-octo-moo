<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script type="text/javascript">

$(document).ready(function(){
	window.records = [];
	$("#inputBox").keypress(function(e){
		if(e.keyCode==13)
		$("#recordButton").click();
	});

	$("#bigTextInput").hide();

	$("#bigInputCheck").click(function(){
		$("#inputBox").toggle(!this.checked).val("");
		$("#bigTextInput").toggle(this.checked).val("");
	});
});

function record(){

	var linedInput = $(
			($("#inputBox").is(":visible")) //if inputBox is visible
				?	("#inputBox")   //then use inputBox
				:	("#bigTextInput")//else use bigTextInput (textArea)
			).val().split("\n");

	$.each(linedInput,function(index,value){ //for each line
		var splitOnSpace = value.split(" ");
		$.each(splitOnSpace ,function(wordIndex, wordValue){ //for each word
			window.records.push(wordValue);
		});
		$("#listId").append("<li>" + value + "</li>");
	});
	$("#bigTextInput").val("");

}

function wordFrequency(givenWord){
	var occurrences = 0;

	var matchResults = [];

	$.each($(window).attr("records"),function(index,value){ //for each recorded word
		if(value.toLowerCase().indexOf(givenWord.toLowerCase()) >= 0){
			occurrences++;
		}
	});
	var returnPercentage = ((occurrences / $(window).attr("records").length*100)||0).toFixed(2)
	return parseFloat(returnPercentage)
}

function binarySearchArray(searchArray, valuePair){
    //TODO
    //searchArray is set of items in same format as valuePair
    //valuePair in format of ["word", frequencyAsFloat]

    var middleIndex = Math.ceil(searchArray.length / 2) - 1;
    var sizeIndicatesLastStep = (searchArray.length <= 3);
    var binarySearchRecursedResult = 0;
    //compare middle index
    if (searchArray[middleIndex][1] == valuePair[1]) {
        //found it
        //this is a problem, since we should NEVER find it
        //fatal exception (funny that finding something you're searching for in a search function means something went wrong)
    } else if (searchArray[middleIndex][1] < valuePair[1]) {
        //item is in second half
        if (sizeIndicatesLastStep) {
            //will return something in this function
        } //if this statement triggers, it will return the function, so we don't need an 'else'

        binarySearchRecursedResult = binarySearchArray(searchArray.slice(middleIndex + 1), valuePair);
        //now translate recursed index result to actua index and return appropriately
    } else if (searchArray[middleIndex][1] > valuePair[1]) {
        //item is in first half
        if (sizeIndicatesLastStep) {
            //will return something in this function
        }

        binarySearchRecursedResult = binarySearchArray(searchArray.slice(0, middleIndex-1), valuePair);
    } else {
        //comparisons always return False, improper value somewhere, fatal error
        //perhaps somehow a NaN or such made it into the rankDictionary
        //calculation of returnPercentage in wordFrequency should prevent this
    }
}

function rankWordFrequency(){
	var rankDictionary = [];

	//rank Dictionary is a list of arrays as value pairs, being a word and that word's frequency
	//the actual 'rank' is easily obtained from the pair's index in the array, splice and inserting words in the correct place
	//maintains the index as rank (though -1)

	$.each($(window).attr("records"),function(index,value){
		//for each word, does word exist in rankDictionary?
		if( !inArrayRecursive(rankDictionary, value)[0] ){	//word does not exist in rankDictionary, proceed.
			var valueFrequency = wordFrequency(value);
			//we have the frequency, now we must find where in the dictionary to insert it

			var thisPair = [value, valueFrequency];
		    //var result = binarySearchArray(rankDictionary,thisPair);
			//rankDictionary.splice(result, 0, thisPair);
		}
	});
}

/*
inArrayRecursive finds the first matching record, not all matching records
this is because this is meant to be used to search a single depth list
in fact this function's recursive ability probably isn't neccessary
but who knows i may end up using it in some other code one day
*/

function inArrayRecursive(ArrayToSearch, SampleArrayItemToSearchFor){ 
	var foundItem = false;
	var foundIndexList = [];
	for(var i = 0; i < ArrayToSearch.length;i++){
		// for every item in the array, are any of them arrays?
		if(Array.isArray(ArrayToSearch[i])){
			var innerArrayResult = inArrayRecursive(ArrayToSearch[i], SampleArrayItemToSearchFor);
			if(innerArrayResult[0] == true){ //the item is found recursively somewhere
				foundItem = true;	
				foundIndexList = innerArrayResult[1];
				foundIndexList.push(i);
				return([foundItem,foundIndexList]);
			}
		}
		else{	//item is not an array, check to see if it contains our value
			if(ArrayToSearch[i] == SampleArrayItemToSearchFor){
				//found the item
				foundItem = true;	
				foundIndexList.push(i);
				return([foundItem,foundIndexList]);
			}
		}
	}
	//if we made it here then we were never returned, so we can assume the search didn't find anything
	return([false]);
		
}
</script>
</head>
<body>
<input type="button" id="recordButton" value="Record" onclick="record()"/>
<br>
Big Input Mode <input type="checkbox" id="bigInputCheck"/>
<br>
<input type="text" id="inputBox" placeholder="Enter Text Here."/>
<textarea rows="10" cols="60" id="bigTextInput" placeholder="Enter Text Here. Input will be seperated line-by-line."></textarea>
<br>
<ol id="listId">
</ol>
</body>
</html>